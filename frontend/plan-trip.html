<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plan Trip - TripCraft</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="plan-trip">
  <nav class="navbar">
    <div class="logo">TripCraft</div>
    <ul class="nav-links">
      <li><a href="home.html">🏠 Home</a></li>
      <li><a href="plan-trip.html">🗺️ Plan Trip</a></li>
      <li><a  href="#">🗓️ Itinerary</a></li>
      <li><a href="#"> ✈️ Flights</a></li>
      <li><a href="#">🚆 Trains</a></li>
      <li><a href="#">🚌 Buses</a></li>
      <li><a href="#">🏨 Hotels</a></li>
      <li><a href="#">💰 Expenses</a></li>
      
    </ul>
  </nav>

  <main class="plan-container">
    <h1>Plan a new trip</h1>
    <form>
      <label for="destination">Where to?</label>
     <select id="destination" name="destination">
    <option value="">--Select a place--</option>
    <option value="pune">Pune</option>
    <option value="jaipur">Jaipur</option>
    <option value="goa">Goa</option>
    <option value="manali">Manali</option>
    <option value="kerela">Kerela</option>
    <option value="japan">Japan</option>
    <option value="south-korea">South Korea</option>
    <option value="spain">Spain</option>
    <option value="dubai">Dubai</option>
    <option value="greece">Greece</option>
    <option value="other">Other</option>
  </select>

  <div class="date-inputs">
    <div class="date-group">
      <label for="start-date">Start Date</label>
      <input type="date" id="start-date">
    </div>
    <div class="date-group">
      <label for="end-date">End Date</label>
      <input type="date" id="end-date">
    </div>
  </div>
  
  <label for="travelType">Travel Type:</label>
  <select id="travelType" name="travelType">
    <option value="solo">Solo</option>
    <option value="couple">Couple</option>
    <option value="group">Group</option>
    <option value="family">Family</option>
  </select>

  <button type="submit" class="cta-btn">Start planning</button>
  <p><a href="destination.html">Or write a new guide</a></p>
</form>

</main>

  <footer>
  <div class="footer-container">
    <div class="footer-section">
      <h3>TripCraft</h3>
      <p><a href="blog.html">Blog</a></p>
      <p><a href="report.html">Report security issue</a></p>
      <p><a href="terms.html">Terms, Privacy policy & Copyright</a></p>
    </div>
    <div class="footer-section">
      <h3>Guides & Resources</h3>
      <p><a href="explore.html">Explore cities & countries</a></p>
      <p><a href="roadtrips.html">Road trips</a></p>
      <p><a href="itinerary.html">Itinerary guides</a></p>
    </div>
    <div class="footer-section">
      <!-- Additional sections if needed -->
    </div>
  </div>
  <p class="footer-bottom">Made with ❤️ by TripCraft © 2025</p>
</footer>

<script>
  const API_BASE_URL = 'http://localhost:8080/api';

  // Check if user is logged in
  if (!localStorage.getItem('isLoggedIn')) {
    window.location.href = 'login.html';
  }

  // Get current user
  const currentUser = JSON.parse(localStorage.getItem('user') || '{}');

  // Form submission handler
  document.querySelector('form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const destination = document.getElementById('destination').value;
    const startDate = document.getElementById('start-date').value;
    const endDate = document.getElementById('end-date').value;
    const travelType = document.getElementById('travelType').value;
    
    if (!destination || !startDate || !endDate) {
      alert('Please fill in all required fields');
      return;
    }
    
    if (new Date(startDate) >= new Date(endDate)) {
      alert('End date must be after start date');
      return;
    }
    
    try {
      const response = await fetch(`${API_BASE_URL}/trips`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          userId: currentUser.userId,
          fromLocation: 'Current Location', // You can make this dynamic
          toLocation: destination,
          startDate: startDate,
          endDate: endDate,
          transportMode: 'flight' // Default, can be made dynamic
        })
      });
      
      const result = await response.json();
      
      if (result.success) {
        alert('Trip created successfully!');
        // Store trip ID for future use
        localStorage.setItem('currentTrip', JSON.stringify(result.data));
        window.location.href = 'flight.html';
      } else {
        alert('Failed to create trip: ' + result.message);
      }
    } catch (error) {
      console.error('Trip creation error:', error);
      alert('Failed to create trip. Please try again.');
    }
  });
</script>

</body>
</html>