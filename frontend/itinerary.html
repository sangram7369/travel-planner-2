<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TripCraft - Itinerary Planner</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- External CSS -->
    <link rel="stylesheet" href="itinerary.css">
</head>

<body>

    <!-- Fixed Header -->
    <header class="fixed-top">
        <nav class="navbar navbar-expand-md navbar-dark bg-primary custom-navbar">
            <div class="container">
                <a href="home.html" class="navbar-brand fw-bold fs-3">TripCraft</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                    <ul class="navbar-nav gap-md-3">
                        <li class="nav-item"><a class="nav-link" href="home.html">🏠 Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="plan-trip.html">🗺️ Plan Trip</a></li>
                        <li class="nav-item"><a class="nav-link active" aria-current="page" href="itinerary.html">🗓️
                                Itinerary</a></li>
                        <li class="nav-item"><a class="nav-link" href="flight.html">✈️ Flights</a></li>
                        <li class="nav-item"><a class="nav-link" href="train.html">🚆 Trains</a></li>
                        <li class="nav-item"><a class="nav-link" href="bus.html">🚌 Buses</a></li>
                        <li class="nav-item"><a class="nav-link" href="hotel.html">🏨 Hotels</a></li>
                        <li class="nav-item"><a class="nav-link" href="expenses.html">💸 Expenses</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Landing View -->
        <section id="landing-view" class="landing-hero">
            <div class="container text-center text-white">
                <p class="text-uppercase small-caps">Your Adventure Starts Here</p>
                <h1 class="display-3 fw-bolder">Craft Unforgettable <span class="highlight-text">Journeys</span></h1>
                <p class="lead col-md-8 mx-auto">For the traveler who plans every detail and the one who loves a
                    surprise—we've built this for you.</p>
                <div class="d-flex justify-content-center mt-5">
                    <div class="craft-journey-card">
                        <div class="card-icon"><i class="fas fa-pencil-alt"></i></div>
                        <h3 class="fw-bold">Craft Your Journey</h3>
                        <p>Design every detail of your perfect trip with our intuitive itinerary builder.</p>
                        <ul class="text-start">
                            <li>Drag-and-drop planning</li>
                            <li>Real-time collaboration</li>
                            <li>100% customizable</li>
                        </ul>
                        <button class="btn btn-light btn-lg" id="lets-begin-btn">Let's Begin →</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Itinerary Builder View (Initially Hidden) -->
        <section id="builder-view" class="d-none py-5">
            <div class="container">
                <div class="row g-4">
                    <!-- Left Column: Controls -->
                    <div class="col-lg-4">
                        <div class="controls-panel">
                            <div class="card mb-4">
                                <div class="card-body">
                                    <h5 class="fw-bold"><i class="fas fa-map-marked-alt me-2"></i> Plan Your Trip</h5>
                                    <label for="city-select" class="form-label">Select a City</label>
                                    <select id="city-select" class="form-select">
                                        <option selected disabled>-- Choose a destination --</option>
                                        <option value="New York">New York</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Paris">Paris</option>
                                    </select>
                                </div>
                            </div>
                            <div id="activities-panel" class="d-none">
                                <h5 class="fw-bold mb-3">Activities in <span id="city-name"></span></h5>
                                <div class="card">
                                    <div class="card-body" id="suggested-activities">
                                        <!-- Suggested activities will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Right Column: Itinerary -->
                    <div class="col-lg-8">
                        <div class="itinerary-panel">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h3 class="fw-bold">Your Itinerary</h3>
                                <div>
                                    <button class="btn btn-primary" id="add-day-btn"><i class="fas fa-plus me-2"></i>Add
                                        Day</button>
                                    <button class="btn btn-success" id="download-btn"><i
                                            class="fas fa-download me-2"></i>Download</button>
                                    <button class="btn btn-danger" id="clear-btn"><i
                                            class="fas fa-trash me-2"></i>Clear</button>
                                </div>
                            </div>
                            <div id="days-container">
                                <div class="text-center p-5 placeholder-view">
                                    <i class="fas fa-route fa-4x text-muted mb-3"></i>
                                    <h4 class="fw-bold">No Days Added Yet!</h4>
                                    <p>Start building your dream itinerary.</p>
                                    <button class="btn btn-lg btn-primary" id="add-first-day-btn">Add Your First
                                        Day</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Fixed Footer -->
    <footer class="bg-dark text-white text-center fixed-bottom">
        <div class="container py-3">
            <p class="mb-0 small">© 2025 Copyright: Made with <i class="fas fa-heart footer-heart"></i> by TripCraft</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const landingView = document.getElementById('landing-view');
            const builderView = document.getElementById('builder-view');
            const letsBeginBtn = document.getElementById('lets-begin-btn');

            const citySelect = document.getElementById('city-select');
            const activitiesPanel = document.getElementById('activities-panel');
            const cityNameSpan = document.getElementById('city-name');
            const suggestedActivitiesContainer = document.getElementById('suggested-activities');

            const addDayBtn = document.getElementById('add-day-btn');
            const addFirstDayBtn = document.getElementById('add-first-day-btn');
            const daysContainer = document.getElementById('days-container');
            const clearBtn = document.getElementById('clear-btn');
            const downloadBtn = document.getElementById('download-btn');

            let dayCounter = 0;

            const activitiesData = {
                "New York": ["Explore Times Square", "Visit Central Park", "Statue of Liberty & Ellis Island", "See a Broadway Show"],
                "Jaipur": ["Visit Amber Fort", "Explore Hawa Mahal", "City Palace Tour", "Shop at Johari Bazaar"],
                "Paris": ["Visit the Eiffel Tower", "Explore the Louvre Museum", "Walk along the Seine River", "See the Arc de Triomphe"]
            };

            letsBeginBtn.addEventListener('click', () => {
                landingView.classList.add('d-none');
                builderView.classList.remove('d-none');
            });

            citySelect.addEventListener('change', () => {
                const selectedCity = citySelect.value;
                cityNameSpan.textContent = selectedCity;
                suggestedActivitiesContainer.innerHTML = '';

                if (activitiesData[selectedCity]) {
                    activitiesData[selectedCity].forEach(activityText => {
                        const activityEl = document.createElement('div');
                        activityEl.className = 'suggested-activity';
                        activityEl.textContent = activityText;
                        activityEl.draggable = true;
                        activityEl.addEventListener('dragstart', handleDragStart);
                        suggestedActivitiesContainer.appendChild(activityEl);
                    });
                }
                activitiesPanel.classList.remove('d-none');
            });

            const addDay = () => {
                if (dayCounter === 0) {
                    daysContainer.innerHTML = '';
                }
                dayCounter++;
                const dayId = `day-${dayCounter}`;
                const dayCard = document.createElement('div');
                dayCard.className = 'card day-card mb-3';
                dayCard.innerHTML = `
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0 fw-bold">Day ${dayCounter}</h5>
                        <input type="date" class="form-control" style="width: auto;">
                    </div>
                    <div class="card-body activity-drop-zone" id="${dayId}">
                        <p class="text-muted text-center small">Drag activities here or add a custom one below.</p>
                    </div>
                    <div class="card-footer">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Add custom activity...">
                            <button class="btn btn-outline-secondary">Add</button>
                        </div>
                    </div>
                `;
                daysContainer.appendChild(dayCard);

                const dropZone = dayCard.querySelector('.activity-drop-zone');
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('drop', handleDrop);

                const customAddBtn = dayCard.querySelector('button');
                customAddBtn.addEventListener('click', () => {
                    const input = dayCard.querySelector('input[type="text"]');
                    if (input.value.trim()) {
                        addActivityToDay(dropZone, input.value.trim());
                        input.value = '';
                    }
                });
            };

            addDayBtn.addEventListener('click', addDay);
            addFirstDayBtn.addEventListener('click', addDay);

            clearBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear the entire itinerary?')) {
                    daysContainer.innerHTML = `<div class="text-center p-5 placeholder-view">...</div>`;
                    dayCounter = 0;
                }
            });

            // --- DOWNLOAD FUNCTIONALITY ---
            downloadBtn.addEventListener('click', () => {
                let itineraryText = `Your Trip Itinerary - ${citySelect.value}\n\n`;

                const dayCards = daysContainer.querySelectorAll('.day-card');
                if (dayCards.length === 0) {
                    alert('Your itinerary is empty. Add some activities first!');
                    return;
                }

                dayCards.forEach((card, index) => {
                    const dayTitle = card.querySelector('h5').textContent;
                    const dateValue = card.querySelector('input[type="date"]').value;
                    itineraryText += `--------------------\n${dayTitle} (${dateValue || 'No date set'})\n--------------------\n`;

                    const activities = card.querySelectorAll('.activity-item');
                    if (activities.length > 0) {
                        activities.forEach(activity => {
                            itineraryText += `- ${activity.textContent}\n`;
                        });
                    } else {
                        itineraryText += 'No activities planned for this day.\n';
                    }
                    itineraryText += '\n';
                });

                // Create a blob from the text
                const blob = new Blob([itineraryText], { type: 'text/plain' });
                // Create a temporary link to trigger the download
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'My-Trip-Itinerary.txt';

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });

            let draggedItem = null;

            function handleDragStart(e) { draggedItem = e.target; }
            function handleDragOver(e) { e.preventDefault(); }

            function handleDrop(e) {
                e.preventDefault();
                if (e.target.classList.contains('activity-drop-zone')) {
                    addActivityToDay(e.target, draggedItem.textContent);
                }
            }

            function addActivityToDay(dayContainer, text) {
                const placeholder = dayContainer.querySelector('p');
                if (placeholder) placeholder.remove();

                const activityItem = document.createElement('div');
                activityItem.className = 'activity-item';
                activityItem.textContent = text;
                dayContainer.appendChild(activityItem);
            }
        });
    </script>
</body>

</html>